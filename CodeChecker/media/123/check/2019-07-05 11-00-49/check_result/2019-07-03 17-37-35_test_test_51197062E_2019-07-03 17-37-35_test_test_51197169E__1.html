<span style="background-color: red">#include&lt;bits/stdc++.h&gt;</span></br>
<span style="background-color: write">#definenmax300005</span></br>
<span style="background-color: write">#definemod1000000007</span></br>
<span style="background-color: red">usingnamespacestd;</span></br>
<span style="background-color: red">typedeflonglongll;</span></br>
<span style="background-color: write">lllazy[4*nmax],arb1[4*nmax],arb2[4*nmax],lef,righ,pos,val,rem,n;</span></br>
<span style="background-color: yellow">lla[nmax],k[nmax];</span></br>
<span style="background-color: greenyellow">voidpropag(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">if(lazy[nod]==0)</span></br>
<span style="background-color: red">return;</span></br>
<span style="background-color: greenyellow">arb1[nod]=arb1[nod]+(dr-st+1)*lazy[nod];</span></br>
<span style="background-color: write">lazy[nod*2]+=lazy[nod];</span></br>
<span style="background-color: greenyellow">lazy[nod*2+1]+=lazy[nod];</span></br>
<span style="background-color: greenyellow">lazy[nod]=0;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">voidupdate1(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">propag(nod,st,dr);</span></br>
<span style="background-color: greenyellow">if(lef&lt;=st&&dr&lt;=righ)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: write">lazy[nod]+=val;</span></br>
<span style="background-color: red">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">llmij=(st+dr)/2;</span></br>
<span style="background-color: greenyellow">if(lef&lt;=mij)</span></br>
<span style="background-color: write">update1(nod*2,st,mij);</span></br>
<span style="background-color: write">if(mij&lt;righ)</span></br>
<span style="background-color: greenyellow">update1(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: greenyellow">propag(nod*2,st,mij);</span></br>
<span style="background-color: write">propag(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: write">arb1[nod]=arb1[nod*2]+arb1[nod*2+1];</span></br>
<span style="background-color: red">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">voidupdate2(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: yellow">if(st==dr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: write">arb2[nod]=val;</span></br>
<span style="background-color: red">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">llmij=(st+dr)/2;</span></br>
<span style="background-color: greenyellow">if(pos&lt;=mij)</span></br>
<span style="background-color: write">update2(nod*2,st,mij);</span></br>
<span style="background-color: yellow">else</span></br>
<span style="background-color: write">update2(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: write">arb2[nod]=arb2[nod*2]+arb2[nod*2+1];</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">llquery1(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">propag(nod,st,dr);</span></br>
<span style="background-color: greenyellow">if(lef&lt;=st&&dr&lt;=righ)</span></br>
<span style="background-color: greenyellow">returnarb1[nod];</span></br>
<span style="background-color: write">llmij=(st+dr)/2,as=0,ad=0;</span></br>
<span style="background-color: write">if(lef&lt;=mij)</span></br>
<span style="background-color: write">as=query1(nod*2,st,mij);</span></br>
<span style="background-color: write">if(mij&lt;righ)</span></br>
<span style="background-color: write">ad=query1(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: greenyellow">returnas+ad;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">voidquery2(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">if(rem==0)</span></br>
<span style="background-color: red">return;</span></br>
<span style="background-color: greenyellow">propag(nod,st,dr);</span></br>
<span style="background-color: greenyellow">if(pos&lt;=st)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: write">if(arb2[nod]==0)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">lazy[nod]+=rem;</span></br>
<span style="background-color: greenyellow">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: greenyellow">if(st==dr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: write">lldif=min(rem,arb2[nod]);</span></br>
<span style="background-color: write">rem-=dif;</span></br>
<span style="background-color: write">arb2[nod]-=dif;</span></br>
<span style="background-color: greenyellow">lazy[nod]+=rem;</span></br>
<span style="background-color: yellow">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">}</span>
<span style="background-color: write">llmij=(st+dr)/2;</span></br>
<span style="background-color: write">if(pos&lt;=mij)</span></br>
<span style="background-color: write">query2(nod*2,st,mij);</span></br>
<span style="background-color: write">query2(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: write">propag(nod*2,st,mij);</span></br>
<span style="background-color: write">propag(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: write">arb1[nod]=arb1[nod*2]+arb1[nod*2+1];</span></br>
<span style="background-color: red">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">voidactval(lli)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: write">if(i==1||i&gt;n)return;</span></br>
<span style="background-color: write">val=a[i-1]+k[i-1];</span></br>
<span style="background-color: write">val=a[i]-val;</span></br>
<span style="background-color: yellow">pos=i;</span></br>
<span style="background-color: yellow">update2(1,1,n);</span></br>
<span style="background-color: write">}</span>
<span style="background-color: greenyellow">intmain()</span></br>
<span style="background-color: write">{</span>
<span style="background-color: write">lli,q,x;</span></br>
<span style="background-color: yellow">charop;</span></br>
<span style="background-color: red">ios::sync_with_stdio(false);</span></br>
<span style="background-color: red">cin&gt;&gt;n;</span></br>
<span style="background-color: red">for(i=1;i&lt;=n;i++)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: red">cin&gt;&gt;a[i];</span></br>
<span style="background-color: write">}</span>
<span style="background-color: yellow">for(i=1;i&lt;n;i++)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: red">cin&gt;&gt;k[i];</span></br>
<span style="background-color: greenyellow">a[i+1]=max(a[i+1],a[i]+k[i]);</span></br>
<span style="background-color: write">val=a[i];</span></br>
<span style="background-color: write">lef=righ=i;</span></br>
<span style="background-color: write">update1(1,1,n);</span></br>
<span style="background-color: write">actval(i);</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">lef=righ=n;</span></br>
<span style="background-color: write">val=a[n];</span></br>
<span style="background-color: write">update1(1,1,n);</span></br>
<span style="background-color: write">actval(n);</span></br>
<span style="background-color: red">cin&gt;&gt;q;</span></br>
<span style="background-color: red">while(q--)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">cin&gt;&gt;op;</span></br>
<span style="background-color: write">if(op=='+')</span></br>
<span style="background-color: write">{</span>
<span style="background-color: write">cin&gt;&gt;i&gt;&gt;x;</span></br>
<span style="background-color: greenyellow">if(x==0)</span></br>
<span style="background-color: write">continue;</span></br>
<span style="background-color: write">lef=righ=i;</span></br>
<span style="background-color: write">a[i]=query1(1,1,n);</span></br>
<span style="background-color: greenyellow">a[i]+=x;</span></br>
<span style="background-color: write">val=x;</span></br>
<span style="background-color: write">update1(1,1,n);</span></br>
<span style="background-color: greenyellow">if(i!=1)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">lef=righ=i-1;</span></br>
<span style="background-color: write">a[i-1]=query1(1,1,n);</span></br>
<span style="background-color: write">actval(i);</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">pos=i+1;rem=x;</span></br>
<span style="background-color: write">query2(1,1,n);</span></br>
<span style="background-color: write">}</span>
<span style="background-color: yellow">else</span></br>
<span style="background-color: write">{</span>
<span style="background-color: write">cin&gt;&gt;lef&gt;&gt;righ;</span></br>
<span style="background-color: write">cout&lt;&lt;query1(1,1,n)&lt;&lt;'\n';</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">}</span>
<span style="background-color: write">return0;</span></br>
<span style="background-color: write">}</span>
