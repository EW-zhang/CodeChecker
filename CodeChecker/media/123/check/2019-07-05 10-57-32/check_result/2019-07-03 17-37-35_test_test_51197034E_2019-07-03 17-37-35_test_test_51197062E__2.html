<span style="background-color: red">#include&lt;bits/stdc++.h&gt;</span></br>
<span style="background-color: white">#definenmax300005</span></br>
<span style="background-color: white">#definemod1000000007</span></br>
<span style="background-color: red">usingnamespacestd;</span></br>
<span style="background-color: greenyellow">typedeflonglongll;</span></br>
<span style="background-color: white">lllazy[4*nmax],arb1[4*nmax],arb2[4*nmax],lef,righ,pos,val,rem,n;</span></br>
<span style="background-color: greenyellow">lla[nmax],k[nmax];</span></br>
<span style="background-color: white">voidpropag(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">if(lazy[nod]==0)</span></br>
<span style="background-color: red">return;</span></br>
<span style="background-color: white">arb1[nod]=arb1[nod]+(dr-st+1)*lazy[nod];</span></br>
<span style="background-color: white">lazy[nod*2]+=lazy[nod];</span></br>
<span style="background-color: white">lazy[nod*2+1]+=lazy[nod];</span></br>
<span style="background-color: white">lazy[nod]=0;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: greenyellow">voidupdate1(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">propag(nod,st,dr);</span></br>
<span style="background-color: greenyellow">if(lef&lt;=st&&dr&lt;=righ)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">lazy[nod]+=val;</span></br>
<span style="background-color: greenyellow">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: white">llmij=(st+dr)/2;</span></br>
<span style="background-color: white">if(lef&lt;=mij)</span></br>
<span style="background-color: white">update1(nod*2,st,mij);</span></br>
<span style="background-color: white">if(mij&lt;righ)</span></br>
<span style="background-color: white">update1(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: white">propag(nod*2,st,mij);</span></br>
<span style="background-color: white">propag(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: white">arb1[nod]=arb1[nod*2]+arb1[nod*2+1];</span></br>
<span style="background-color: greenyellow">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: greenyellow">voidupdate2(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: yellow">if(st==dr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">arb2[nod]=val;</span></br>
<span style="background-color: greenyellow">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: white">llmij=(st+dr)/2;</span></br>
<span style="background-color: white">if(pos&lt;=mij)</span></br>
<span style="background-color: white">update2(nod*2,st,mij);</span></br>
<span style="background-color: red">else</span></br>
<span style="background-color: white">update2(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: white">arb2[nod]=arb2[nod*2]+arb2[nod*2+1];</span></br>
<span style="background-color: write">}</span>
<span style="background-color: white">llquery1(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">propag(nod,st,dr);</span></br>
<span style="background-color: greenyellow">if(lef&lt;=st&&dr&lt;=righ)</span></br>
<span style="background-color: greenyellow">returnarb1[nod];</span></br>
<span style="background-color: white">llmij=(st+dr)/2,as=0,ad=0;</span></br>
<span style="background-color: white">if(lef&lt;=mij)</span></br>
<span style="background-color: white">as=query1(nod*2,st,mij);</span></br>
<span style="background-color: white">if(mij&lt;righ)</span></br>
<span style="background-color: white">ad=query1(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: white">returnas+ad;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: white">voidquery2(llnod,llst,lldr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">if(rem==0)</span></br>
<span style="background-color: white">return;</span></br>
<span style="background-color: white">propag(nod,st,dr);</span></br>
<span style="background-color: white">if(pos&lt;=st)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">if(arb2[nod]==0)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">lazy[nod]+=rem;</span></br>
<span style="background-color: white">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: greenyellow">if(st==dr)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">lldif=min(rem,arb2[nod]);</span></br>
<span style="background-color: white">rem-=dif;</span></br>
<span style="background-color: white">arb2[nod]-=dif;</span></br>
<span style="background-color: white">lazy[nod]+=rem;</span></br>
<span style="background-color: white">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">}</span>
<span style="background-color: white">llmij=(st+dr)/2;</span></br>
<span style="background-color: white">if(pos&lt;=mij)</span></br>
<span style="background-color: white">query2(nod*2,st,mij);</span></br>
<span style="background-color: white">query2(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: white">propag(nod*2,st,mij);</span></br>
<span style="background-color: white">propag(nod*2+1,mij+1,dr);</span></br>
<span style="background-color: white">arb1[nod]=arb1[nod*2]+arb1[nod*2+1];</span></br>
<span style="background-color: white">return;</span></br>
<span style="background-color: write">}</span>
<span style="background-color: white">voidactval(lli)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">if(i==1||i&gt;n)return;</span></br>
<span style="background-color: greenyellow">val=a[i-1]+k[i-1];</span></br>
<span style="background-color: white">val=a[i]-val;</span></br>
<span style="background-color: white">pos=i;</span></br>
<span style="background-color: white">update2(1,1,n);</span></br>
<span style="background-color: write">}</span>
<span style="background-color: yellow">intmain()</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">lli,q,x;</span></br>
<span style="background-color: white">charop;</span></br>
<span style="background-color: white">ios::sync_with_stdio(false);</span></br>
<span style="background-color: greenyellow">cin&gt;&gt;n;</span></br>
<span style="background-color: greenyellow">for(i=1;i&lt;=n;i++)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">cin&gt;&gt;a[i];</span></br>
<span style="background-color: write">}</span>
<span style="background-color: white">for(i=1;i&lt;n;i++)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: yellow">cin&gt;&gt;k[i];</span></br>
<span style="background-color: white">a[i+1]=max(a[i+1],a[i]+k[i]);</span></br>
<span style="background-color: white">val=a[i];</span></br>
<span style="background-color: white">lef=righ=i;</span></br>
<span style="background-color: white">update1(1,1,n);</span></br>
<span style="background-color: white">actval(i);</span></br>
<span style="background-color: write">}</span>
<span style="background-color: white">lef=righ=n;</span></br>
<span style="background-color: white">val=a[n];</span></br>
<span style="background-color: white">update1(1,1,n);</span></br>
<span style="background-color: white">actval(n);</span></br>
<span style="background-color: greenyellow">cin&gt;&gt;q;</span></br>
<span style="background-color: white">while(q--)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: yellow">cin&gt;&gt;op;</span></br>
<span style="background-color: white">if(op=='+')</span></br>
<span style="background-color: write">{</span>
<span style="background-color: greenyellow">cin&gt;&gt;i&gt;&gt;x;</span></br>
<span style="background-color: white">if(x==0)</span></br>
<span style="background-color: white">continue;</span></br>
<span style="background-color: white">lef=righ=i;</span></br>
<span style="background-color: white">a[i]=query1(1,1,n);</span></br>
<span style="background-color: white">a[i]+=x;</span></br>
<span style="background-color: white">val=x;</span></br>
<span style="background-color: white">update1(1,1,n);</span></br>
<span style="background-color: white">if(i!=1)</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">lef=righ=i-1;</span></br>
<span style="background-color: white">a[i-1]=query1(1,1,n);</span></br>
<span style="background-color: white">actval(i);</span></br>
<span style="background-color: write">}</span>
<span style="background-color: white">pos=i+1;rem=x;</span></br>
<span style="background-color: greenyellow">query2(1,1,n);</span></br>
<span style="background-color: write">}</span>
<span style="background-color: red">else</span></br>
<span style="background-color: write">{</span>
<span style="background-color: white">cin&gt;&gt;lef&gt;&gt;righ;</span></br>
<span style="background-color: white">cout&lt;&lt;query1(1,1,n)&lt;&lt;'\n';</span></br>
<span style="background-color: write">}</span>
<span style="background-color: write">}</span>
<span style="background-color: white">return0;</span></br>
<span style="background-color: write">}</span>
